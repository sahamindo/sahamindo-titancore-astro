---
import Layout from '@layouts/Layout.astro';
import Hero from '@components/sections/Hero.astro';
import SplitPanel from '@components/sections/SplitPanel.astro';
import Features from '@components/sections/Features.astro';
import Stats from '@components/sections/Stats.astro';
import { featureLists } from '@data/features';
import { statsLists } from '@data/stats';
import Logos from '@components/sections/Logos.astro';
import { logoLists } from '@data/logos';
import CtaBanner from '@components/sections/CtaBanner.astro';
import Faqs from '@components/sections/Faqs.astro';
import { faqLists } from '@data/faqs';
import RecentPosts from '@components/sections/RecentPosts.astro';
import heroImage from '../assets/images/home/default-hero-2.jpg';
import styleGuideImage from '../assets/images/home/developer.jpg';
import { getCollection } from 'astro:content';
import NewsArticle from '@components/news/NewsArticle.astro';
import { marketSectors } from '@data/categories';
import { Newspaper, TrendingUp, Target, BarChart3 } from 'lucide-astro';

const seoTitle = "Sahamindo - Portal Berita Saham Indonesia";
const seoDescription = "Portal berita dan analisis pasar saham Indonesia terkini. Informasi sektor perbankan, IPO, barang konsumen, dan infrastruktur untuk investor cerdas.";

// Get latest news articles
const allNews = await getCollection('news', ({ data }) => {
    return import.meta.env.DEV || data.publish !== false;
});

// Sort by date and get latest
const latestNews = allNews
    .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime())
    .slice(0, 6);

const breakingNews = latestNews.filter(article => article.data.isBreaking).slice(0, 2);

const heroContent = {
    title: 'Portal Berita Pasar Saham Indonesia',
    description: 'Dapatkan informasi terkini dan analisis mendalam tentang pergerakan saham di Bursa Efek Indonesia. Pantau sektor perbankan, IPO, barang konsumen, dan infrastruktur untuk keputusan investasi yang tepat.',
    buttons: [
        {
            text: 'Berita Terkini',
            link: '/berita',
            target: '_self'
        },
        {
            text: 'Analisis Pasar',
            link: '/analisis',
            target: '_self'
        }
    ],
    backgroundImage: heroImage,
    overlayOpacity: 0.2
}

const featuresSection = {
    eyebrow: "MENGAPA SAHAMINDO",
    title: "Sumber Informasi Terpercaya untuk Investor Indonesia",
    description: "Sahamindo menyediakan berita real-time, analisis mendalam, dan data pasar yang akurat untuk membantu Anda membuat keputusan investasi yang tepat di pasar saham Indonesia.",
    features: [
        {
            title: "Berita Real-Time",
            description: "Update berita pasar saham terkini dari Bursa Efek Indonesia",
            icon: Newspaper
        },
        {
            title: "Analisis Mendalam",
            description: "Analisis fundamental dan teknikal dari para ahli pasar modal",
            icon: TrendingUp
        },
        {
            title: "Fokus Sektor",
            description: "Liputan khusus sektor perbankan, IPO, konsumer, dan infrastruktur",
            icon: Target
        },
        {
            title: "Data Akurat",
            description: "Data pergerakan saham dan indeks yang akurat dan terpercaya",
            icon: BarChart3
        }
    ],
    button: {
        text: "Semua Berita",
        link: "/berita",
        variant: "primary" as const
    }
}

const FooterCta = {
    eyebrow: "Tetap Update",
    title: 'Jangan Lewatkan Berita Pasar Terbaru',
    description: 'Dapatkan notifikasi untuk breaking news dan analisis penting langsung ke email Anda. Pantau pergerakan saham favorit Anda dengan mudah.',
    hideCta: false,
    button: {
        text: 'Berlangganan Newsletter',
        link: '/kontak',
        target: '_self'
    }
}

const styleGuideSection = {
    eyebrow: "Design System",
    headline: "Consistent & Beautiful Components",
    description: "Titan Core comes with a complete style guide to ensure your projects maintain visual consistency. From typography to interactive elements, we've carefully crafted each component.",
    image: {
        src: styleGuideImage,
        alt: "Featured image"
    },
    buttons: [
        {
            text: "Explore Style Guide",
            link: "/style-guide",
            variant: "primary" as const
        }
    ]
}

const sideBySideStats = {
    eyebrow: "Statistik Platform",
    title: "Cakupan Lengkap Pasar Modal Indonesia",
    description: "Sahamindo menyediakan liputan komprehensif untuk seluruh ekosistem pasar modal Indonesia, dengan fokus pada sektor-sektor kunci yang menggerakkan ekonomi nasional.",
    variant: 'side-by-side' as const,
    stats: statsLists.withContent.stats,
    content: statsLists.withContent.content
};

const mainCta = {
    eyebrow: "Build Blocks",
    title: "Ready-to-Use Components",
    description: "Save development time with our pre-built, accessible components. Each one is designed to integrate seamlessly with your projects while maintaining excellent performance.",
    button: {
        text: "View All Components",
        link: "/components",
        variant: "primary" as const,
        target: "_self" as const
    }
};


const logosSection = {
    eyebrow: "Our Clients",
    logos: logoLists.main.logos
}

const faqsSection = {
    eyebrow: "Tanya Jawab",
    title: 'Pertanyaan yang Sering Diajukan',
    description: 'Temukan jawaban untuk pertanyaan umum tentang investasi saham dan platform Sahamindo.',
    faqs: faqLists.main.faqs
}

const recentPostsSection = {
    eyebrow: "BERITA TERKINI",
    title: "Update Pasar Saham Indonesia",
    description: "Berita dan analisis terbaru dari Bursa Efek Indonesia. Pantau pergerakan saham-saham pilihan dan sektor unggulan.",
    button: {
            text: "Semua Berita",
            link: "/berita",
        variant: "primary" as const
    }
}
---

<Layout footerCta={FooterCta} title={seoTitle} description={seoDescription}>
    <Hero content={heroContent} />
    
    {/* Breaking News Section */}
    {breakingNews.length > 0 && (
        <section class="site-container mx-auto px-4 py-8">
            <div class="bg-red-50 border border-red-200 rounded-lg p-6" data-aos="fade-up">
                <h2 class="text-2xl font-bold text-red-800 mb-4 flex items-center gap-2">
                    <span class="animate-pulse">ðŸ”´</span>
                    Breaking News
                </h2>
                <div class="grid md:grid-cols-2 gap-4">
                    {breakingNews.map((article, index) => (
                        <NewsArticle
                            title={article.data.title}
                            excerpt={article.data.excerpt}
                            featuredImage={article.data.featuredImage}
                            publishDate={article.data.publishDate}
                            author={article.data.author}
                            category={article.data.category}
                            stockSymbols={article.data.stockSymbols}
                            isBreaking={true}
                            slug={article.id}
                            index={index}
                        />
                    ))}
                </div>
            </div>
        </section>
    )}
    
    {/* Latest News Grid */}
    <section class="site-container mx-auto px-4 py-base">
        <div class="text-center mb-12" data-aos="fade-up">
            <span class="eyebrow">BERITA TERKINI</span>
            <h2 class="text-4xl font-bold mt-4">Update Pasar Saham Indonesia</h2>
            <p class="text-lg text-gray-600 mt-4 max-w-3xl mx-auto">
                Berita dan analisis terbaru dari Bursa Efek Indonesia. Pantau pergerakan saham-saham pilihan dan sektor unggulan.
            </p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
            {latestNews.slice(0, 6).map((article, index) => (
                <NewsArticle
                    title={article.data.title}
                    excerpt={article.data.excerpt}
                    featuredImage={article.data.featuredImage}
                    publishDate={article.data.publishDate}
                    author={article.data.author}
                    category={article.data.category}
                    stockSymbols={article.data.stockSymbols}
                    isBreaking={article.data.isBreaking}
                    slug={article.id}
                    index={index}
                />
            ))}
        </div>
        
        <div class="text-center">
            <a href="/berita" class="inline-flex items-center gap-2 px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors">
                Lihat Semua Berita
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </a>
        </div>
    </section>
    
    {/* Market Sectors */}
    <section class="bg-gray-50 py-base">
        <div class="site-container mx-auto px-4">
            <div class="text-center mb-12" data-aos="fade-up">
                <span class="eyebrow">SEKTOR PASAR</span>
                <h2 class="text-4xl font-bold mt-4">Fokus Sektor Unggulan</h2>
                <p class="text-lg text-gray-600 mt-4 max-w-3xl mx-auto">
                    Analisis mendalam untuk sektor-sektor utama di Bursa Efek Indonesia
                </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                {marketSectors.map((sector, index) => (
                    <a 
                        href={`/sektor/${sector.slug}`}
                        class="group bg-white p-6 rounded-lg border border-gray-200 hover:border-primary hover:shadow-lg transition-all"
                        data-aos="fade-up"
                        data-aos-delay={index * 100}
                    >
                        <div class="text-4xl mb-4">{sector.icon}</div>
                        <h3 class="text-xl font-bold mb-2 group-hover:text-primary transition-colors">{sector.name}</h3>
                        <p class="text-gray-600 text-sm">{sector.description}</p>
                    </a>
                ))}
            </div>
        </div>
    </section>
    
    <Features content={featuresSection} padding="base" background="white" />
    <Stats content={sideBySideStats} background='dark' padding="base"/>
    <Faqs content={faqsSection} background="base" padding="base" />
</Layout>